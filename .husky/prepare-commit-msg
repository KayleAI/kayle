# .husky/prepare-commit-msg

# Get the author info for signing off
SIGNOFF="Signed-off-by: $(git var GIT_AUTHOR_IDENT | sed -n 's/^\(.*>\).*$/\1/p')"

# Check if the commit message file exists, if not create it
COMMIT_MSG_FILE="$1"
if [ ! -f "$COMMIT_MSG_FILE" ]; then
    touch "$COMMIT_MSG_FILE"
fi

# Check if the commit message already has a Signed-off-by line
if ! grep -q "$SIGNOFF" "$COMMIT_MSG_FILE"; then
    sed -i.bak "2i\\
$SIGNOFF\\" "$COMMIT_MSG_FILE" && rm "${COMMIT_MSG_FILE}.bak"
fi